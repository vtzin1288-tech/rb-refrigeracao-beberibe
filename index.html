<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Refrigera칞칚o Berberib</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body { font-family: Arial; background:#f0f2f5; margin:0; padding:0 }
.card { background:#fff; margin:20px; padding:20px; border-radius:8px }
button, input { width:100%; padding:10px; margin-top:10px }
button { background:#0b5ed7; color:#fff; border:none; cursor:pointer }
table { width:100%; border-collapse:collapse; margin-top:10px }
th,td { border:1px solid #ccc; padding:5px; text-align:center }
</style>
</head>

<body>

<div class="card" id="login">
<h3>Login</h3>
<input id="codigo" placeholder="C칩digo (RB01 ou ADM01)">
<input id="nome" placeholder="Nome (qualquer)">
<button onclick="login()">Entrar</button>
</div>

<div class="card" id="func" style="display:none">
<h3>Funcion치rio</h3>

<input id="entrada" placeholder="Hora Entrada">
<input id="almoco" placeholder="Hora Almo칞o">
<input id="volta" placeholder="Volta Almo칞o">
<input id="saida" placeholder="Sa칤da">
<input id="extra" placeholder="Hora Extra">

<button onclick="salvarRegistro()">Salvar Registro</button>
<button onclick="carregarMeus()">Ver Meus Registros</button>
<button onclick="apagarMeus()">Apagar Meus Registros</button>

<div id="meus"></div>
</div>

<div class="card" id="adm" style="display:none">
<h3>츼rea do Patr칚o</h3>
<button onclick="carregarTodos()">Ver Todos Registros</button>
<button onclick="apagarTudo()">Apagar TODOS Registros</button>
<div id="todos"></div>
</div>

<script>
// 游댠 CONFIG FIREBASE (SUBSTITUA)
const firebaseConfig = {
  apiKey: "SUA_API_KEY",
  authDomain: "SEU_DOMINIO",
  databaseURL: "SUA_DATABASE_URL",
  projectId: "SEU_PROJECT_ID",
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let usuario = {};

function login(){
  const c = codigo.value.toUpperCase();
  if(c === "ADM01"){
    usuario = { tipo:"adm" };
    login.style.display="none";
    adm.style.display="block";
  } else if(/^RB\d{2,3}$/.test(c)){
    usuario = { tipo:"func", codigo:c, nome:nome.value || "Sem nome" };
    login.style.display="none";
    func.style.display="block";
  } else {
    alert("C칩digo inv치lido");
  }
}

function salvarRegistro(){
  const data = new Date().toLocaleDateString();
  db.ref("registros").push({
    codigo: usuario.codigo,
    nome: usuario.nome,
    data,
    entrada: entrada.value,
    almoco: almoco.value,
    volta: volta.value,
    saida: saida.value,
    extra: extra.value
  });
  alert("Registro salvo!");
}

function carregarMeus(){
  db.ref("registros").once("value", snap=>{
    let html="<table><tr><th>Data</th><th>Entrada</th><th>Sa칤da</th></tr>";
    snap.forEach(r=>{
      const d=r.val();
      if(d.codigo===usuario.codigo){
        html+=`<tr><td>${d.data}</td><td>${d.entrada}</td><td>${d.saida}</td></tr>`;
      }
    });
    html+="</table>";
    meus.innerHTML=html;
  });
}

function carregarTodos(){
  db.ref("registros").once("value", snap=>{
    let html="<table><tr><th>Nome</th><th>C칩digo</th><th>Data</th></tr>";
    snap.forEach(r=>{
      const d=r.val();
      html+=`<tr><td>${d.nome}</td><td>${d.codigo}</td><td>${d.data}</td></tr>`;
    });
    html+="</table>";
    todos.innerHTML=html;
  });
}

function apagarMeus(){
  if(!confirm("Confirmar?")) return;
  db.ref("registros").once("value", snap=>{
    snap.forEach(r=>{
      if(r.val().codigo===usuario.codigo) r.ref.remove();
    });
  });
}

function apagarTudo(){
  if(!confirm("Tem certeza?")) return;
  if(!confirm("칔ltima confirma칞칚o")) return;
  db.ref("registros").remove();
}
</script>
</body>
</html>
